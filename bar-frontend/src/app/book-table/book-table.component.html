<section class="book-table-section py-5">
  <div class="container">
    <div class="info-wrapper d-flex flex-column flex-lg-row align-items-stretch gap-4">
      <div class="booking-info flex-grow-1">
        <h1 class="section-main-title">Prenota il Tuo Tavolo</h1>
        <p class="section-description">
          Benvenuti al Grecale. Vi invitiamo a prenotare il vostro tavolo per un'esperienza culinaria indimenticabile.
        </p>

        <div class="info-section">
          <h3 class="info-title">Orari di Apertura:</h3>
          <div class="info-content">
            <p class="info-item">Lunedì - Venerdì: 1:00 - 23:00</p>
            <p class="info-item">Sabato - Domenica: 10:00 - 00:00</p>
          </div>
        </div>

        <div class="info-section">
          <h3 class="info-title">Indirizzo:</h3>
          <div class="info-content">
            <p class="info-item">1254 Main Street, Suite 100</p>
            <p class="info-item">Boston, MA 02110</p>
          </div>
        </div>

        <div class="info-section">
          <h3 class="info-title">Chiamaci:</h3>
          <div class="info-content">
            <p class="info-item">+1 (617) 306-12384</p>
          </div>
        </div>
      </div>

      <div class="booking-visual flex-grow-1">
        <div class="booking-visual__frame">
          <img
            class="booking-visual__image"
            src="https://images.unsplash.com/photo-1544145945-f90425340c7e?auto=format&fit=crop&w=1200&q=80"
            alt="Guests dining at Grecale"
          />
          <div class="booking-visual__overlay">
            <span class="booking-visual__badge">Dal 2005</span>
            <p class="booking-visual__caption">Un'esperienza culinaria indimenticabile sulla costa ligure.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="booking-form-container mt-5">
      <h2 class="form-title">Prenota un Tavolo</h2>
      <p class="form-subtitle">Compila il modulo sottostante per effettuare una prenotazione</p>

      <div
        *ngIf="submitSuccess() || submitError()"
        class="alert"
        [class.alert-success]="submitSuccess()"
        [class.alert-danger]="submitError()"
        role="alert"
      >
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <strong *ngIf="submitSuccess()">Richiesta di prenotazione inviata.</strong>
            <span *ngIf="submitSuccess()">Confermeremo la disponibilità a breve.</span>
            <span *ngIf="submitError()">{{ submitError() }}</span>
          </div>
          <button type="button" class="btn-close" aria-label="Chiudi" (click)="dismissAlert()"></button>
        </div>
      </div>

      <form class="booking-form" [formGroup]="bookingForm" (ngSubmit)="submit()" novalidate>
        <div class="row">
          <div class="col-md-4 mb-3">
            <label class="form-label" for="name">Nome</label>
            <input
              id="name"
              type="text"
              class="form-control"
              [class.is-invalid]="hasFieldError('name')"
              formControlName="name"
              placeholder="Inserisci il tuo nome"
              autocomplete="name"
            />
            <div class="invalid-feedback" *ngIf="hasFieldError('name')">
              Per favore, inserisci il tuo nome.
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <label class="form-label" for="email">Email</label>
            <input
              id="email"
              type="email"
              class="form-control"
              [class.is-invalid]="hasFieldError('email')"
              formControlName="email"
              placeholder="Inserisci la tua email"
              autocomplete="email"
            />
            <div class="invalid-feedback" *ngIf="hasFieldError('email')">
              Inserisci un indirizzo email valido per poterti contattare.
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <label class="form-label" for="phone">Telefono</label>
            <input
              id="phone"
              type="tel"
              class="form-control"
              [class.is-invalid]="hasFieldError('phone')"
              formControlName="phone"
              placeholder="Inserisci il tuo numero di telefono"
              autocomplete="tel"
            />
            <div class="invalid-feedback" *ngIf="hasFieldError('phone')">
              Aggiungi un numero di telefono valido.
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label" for="guests">Numero di ospiti</label>
            <select
              id="guests"
              class="form-select"
              [class.is-invalid]="hasFieldError('guests')"
              formControlName="guests"
            >
              <option [ngValue]="null" disabled>Seleziona il numero di ospiti</option>
              <option *ngFor="let option of guestOptions" [ngValue]="option.value">
                {{ option.label }}
              </option>
            </select>
            <div class="invalid-feedback" *ngIf="hasFieldError('guests')">
              Seleziona il numero di ospiti.
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label" for="reservationDateTime">Data e Ora</label>
            <input
              id="reservationDateTime"
              type="datetime-local"
              class="form-control"
              [class.is-invalid]="hasFieldError('reservationDateTime')"
              formControlName="reservationDateTime"
              [attr.min]="minDateTime"
            />
            <div class="invalid-feedback" *ngIf="hasFieldError('reservationDateTime')">
              Scegli una data e un orario preferiti.
            </div>
          </div>
        </div>

        <div class="mb-4">
          <label class="form-label" for="notes">Richieste Speciali (opzionale)</label>
          <textarea
            id="notes"
            rows="4"
            class="form-control"
            [class.is-invalid]="hasFieldError('notes')"
            formControlName="notes"
            placeholder="Eventuali richieste o esigenze particolari..."></textarea>
          <div class="invalid-feedback" *ngIf="hasFieldError('notes')">
            Le richieste speciali non possono superare i 500 caratteri.
          </div>
        </div>

        <button type="submit" class="btn btn-book-now" [disabled]="isSubmitting()">
          <span *ngIf="!isSubmitting()">Prenota Ora</span>
          <span *ngIf="isSubmitting()" class="spinner-border spinner-border-sm align-middle" role="status" aria-hidden="true"></span>
          <span *ngIf="isSubmitting()" class="visually-hidden">Invio in corso...</span>
        </button>
      </form>
    </div>
  </div>
</section>
